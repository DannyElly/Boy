<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>JavaScript 定时器 10</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="cxwu" id="javascript-定时器-10">JavaScript 定时器 10</h1><p data-anchor-id="res8"><code>JS</code></p><hr><div class="md-section-divider"></div><h2 data-anchor-id="lfzk" id="定时器是什么">定时器是什么</h2><p data-anchor-id="a4pi">javaScript中系统提供的函数，用来每隔一段时间或者延迟一段时间执行一段指定的代码，分为两种：</p><ul data-anchor-id="o85w">
<li>重复执行定时器 <code>setInterval</code></li>
<li>延迟执行定时器 <code>setTimeout</code></li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="fnz8" id="定时器的语法">定时器的语法</h2><p data-anchor-id="qf5h"><strong>重复执行定时器</strong></p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="haoz"><ol class="linenums"><li class="L0"><code><span class="com">//setInterval('要做的事儿','间隔时间');</span></code></li><li class="L1"><code><span class="com">//每个 间隔时间 做一次 要做的事。</span></code></li><li class="L2"><code><span class="com">// 间隔时间的单位事毫秒， 没有单位  1s == 1000ms</span></code></li></ol></pre><blockquote data-anchor-id="cjyl" class="white-blockquote">
  <p>需求1：设置一个变量初始为0，让其每隔1秒自增依次，并且打印到控制台中。</p>
</blockquote><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="316y"><ol class="linenums"><li class="L0"><code><span class="kwd">var</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="com">/*setInterval(fn, 1000);</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="com">function fn(){</span></code></li><li class="L5"><code><span class="com">  a++;</span></code></li><li class="L6"><code><span class="com">  console.log(a);</span></code></li><li class="L7"><code><span class="com">}*/</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">setInterval</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(){</span></code></li><li class="L0"><code><span class="pln">  a</span><span class="pun">++;</span></code></li><li class="L1"><code><span class="pln">  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">a</span><span class="pun">);</span></code></li><li class="L2"><code><span class="pun">},</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">);</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="com">/*setInterval('fn()', 1000);  // 虽然可以，不要这么写</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="com">function fn(){</span></code></li><li class="L7"><code><span class="com">  a++;</span></code></li><li class="L8"><code><span class="com">  console.log(a);</span></code></li><li class="L9"><code><span class="com">}*/</span></code></li></ol></pre><p data-anchor-id="3dmc"><strong>延迟执行定时器</strong></p><blockquote data-anchor-id="8bz0" class="white-blockquote">
  <p>需求2：页面上一个div，让其在3秒之后背景颜色由红色变为蓝色。</p>
</blockquote><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="y2gk"><ol class="linenums"><li class="L0"><code><span class="kwd">var</span><span class="pln"> box </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">querySelector</span><span class="pun">(</span><span class="str">'.box'</span><span class="pun">);</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">setTimeout</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">  box</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">backgroundColor </span><span class="pun">=</span><span class="pln"> </span><span class="str">'blue'</span><span class="pun">;</span></code></li><li class="L4"><code><span class="pun">},</span><span class="pln"> </span><span class="lit">3000</span><span class="pun">);</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="o5ms" id="清除定时器">清除定时器</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="0vbo"><ol class="linenums"><li class="L0"><code><span class="com">// 清除定时器也分为两种分别是</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="com">//clearInterval();</span></code></li><li class="L3"><code><span class="com">//clearTimeout();</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="com">// 它们都有一个共同的特性，就是脾气特别好，给我什么都可以。</span></code></li><li class="L6"><code><span class="com">// 如果参数是某个定时器的编号，那么就会清除对应的定时器</span></code></li><li class="L7"><code><span class="com">// 由于定时器的编号在跨浏览器的时候会有兼容性问题，所以通常使用一个变量来存储定时器的返回值</span></code></li></ol></pre><blockquote data-anchor-id="b2dv" class="white-blockquote">
  <p>需求3：设置一个变量初始为0，让其每隔1秒自增依次，并且打印到控制台中，当变量增加到5的时候停止定时器。</p>
</blockquote><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="syud"><ol class="linenums"><li class="L0"><code><span class="kwd">var</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="kwd">var</span><span class="pln"> timer </span><span class="pun">=</span><span class="pln"> setInterval</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">a</span><span class="pun">++);</span></code></li><li class="L4"><code><span class="pln">  </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a </span><span class="pun">==</span><span class="pln"> </span><span class="lit">5</span><span class="pun">){</span></code></li><li class="L5"><code><span class="pln">    clearInterval</span><span class="pun">(</span><span class="pln">timer</span><span class="pun">);</span></code></li><li class="L6"><code><span class="pln">  </span><span class="pun">}</span></code></li><li class="L7"><code><span class="pun">},</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">);</span></code></li></ol></pre><blockquote data-anchor-id="c9my" class="white-blockquote">
  <p>需求4：延时菜单，使用以下结构，当移入按钮，让div显示，此时鼠标从按钮移开到div身上，div可以继续显示，当移开div之后，div消失，如果移开按钮的时候没有移入到div身上，div消失。</p>
</blockquote><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="cofu"><ol class="linenums"><li class="L0"><code><span class="dec">&lt;!DOCTYPE html&gt;</span></code></li><li class="L1"><code><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">lang</span><span class="pun">=</span><span class="atv">"en"</span><span class="tag">&gt;</span></code></li><li class="L2"><code><span class="tag">&lt;head&gt;</span></code></li><li class="L3"><code><span class="pln">  </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">charset</span><span class="pun">=</span><span class="atv">"UTF-8"</span><span class="tag">&gt;</span></code></li><li class="L4"><code><span class="pln">  </span><span class="tag">&lt;title&gt;</span><span class="pln">延时菜单</span><span class="tag">&lt;/title&gt;</span></code></li><li class="L5"><code><span class="pln">  </span><span class="tag">&lt;style&gt;</span></code></li><li class="L6"><code><span class="pln">    </span><span class="pun">.</span><span class="pln">box </span><span class="pun">{</span></code></li><li class="L7"><code><span class="pln">      width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span></code></li><li class="L8"><code><span class="pln">      height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span></code></li><li class="L9"><code><span class="pln">      background</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span></code></li><li class="L0"><code><span class="pln">      display</span><span class="pun">:</span><span class="pln"> none</span><span class="pun">;</span></code></li><li class="L1"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L2"><code><span class="pln">  </span><span class="tag">&lt;/style&gt;</span></code></li><li class="L3"><code><span class="tag">&lt;/head&gt;</span></code></li><li class="L4"><code><span class="tag">&lt;body&gt;</span></code></li><li class="L5"><code><span class="pln">  </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"button"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"按钮"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"btn"</span><span class="tag">&gt;</span></code></li><li class="L6"><code><span class="pln">  </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"box"</span><span class="tag">&gt;&lt;/div&gt;</span></code></li><li class="L7"><code><span class="tag">&lt;/body&gt;</span></code></li><li class="L8"><code><span class="tag">&lt;/html&gt;</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="m41j" id="关于定时器的最小时间间隔">关于定时器的最小时间间隔</h2><p data-anchor-id="zfgg">定时器的时间间隔并不精确，不同的浏览器都有各自的最小间隔，最新的HTML5的规范规定了最小间隔为4ms。</p><div class="md-section-divider"></div><h2 data-anchor-id="94za" id="获取元素计算后样式的数据">获取元素计算后样式的数据</h2><blockquote data-anchor-id="iljw" class="white-blockquote">
  <p><code>getComputedStyle(元素).属性</code></p>
</blockquote><p data-anchor-id="b08w">注意：无法获取<code>transform</code>的样式</p><div class="md-section-divider"></div><h3 data-anchor-id="kuc4" id="封装css函数初步">封装CSS函数（初步）</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="gn3h"><ol class="linenums"><li class="L0"><code><span class="kwd">function</span><span class="pln"> css</span><span class="pun">(){</span></code></li><li class="L1"><code><span class="pln">  </span><span class="kwd">var</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> arguments</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span></code></li><li class="L2"><code><span class="pln">  </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span></code></li><li class="L4"><code><span class="pln">  </span><span class="pun">}</span></code></li><li class="L5"><code><span class="pln">  </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len </span><span class="pun">==</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span></code></li><li class="L6"><code><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">.</span><span class="pln">parseFloat</span><span class="pun">(</span><span class="pln">getComputedStyle</span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])[</span><span class="pln">arguments</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]]);</span></code></li><li class="L7"><code><span class="pln">  </span><span class="pun">}</span></code></li><li class="L8"><code><span class="pln">  </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">len </span><span class="pun">==</span><span class="pln"> </span><span class="lit">3</span><span class="pun">){</span></code></li><li class="L9"><code><span class="pln">    arguments</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">style</span><span class="pun">[</span><span class="pln">arguments</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> arguments</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span></code></li><li class="L0"><code><span class="pln">  </span><span class="pun">}</span></code></li><li class="L1"><code><span class="pun">}</span></code></li></ol></pre><blockquote data-anchor-id="oz4t" class="white-blockquote">
  <p>需求5：点击按钮让div向右以<code>1px/20ms</code>的速度运动。</p>
</blockquote><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="e4jb"><ol class="linenums"><li class="L0"><code><span class="dec">&lt;!DOCTYPE html&gt;</span></code></li><li class="L1"><code><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">lang</span><span class="pun">=</span><span class="atv">"en"</span><span class="tag">&gt;</span></code></li><li class="L2"><code><span class="tag">&lt;head&gt;</span></code></li><li class="L3"><code><span class="pln">  </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">charset</span><span class="pun">=</span><span class="atv">"UTF-8"</span><span class="tag">&gt;</span></code></li><li class="L4"><code><span class="pln">  </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"viewport"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"width=device-width, initial-scale=1.0"</span><span class="tag">&gt;</span></code></li><li class="L5"><code><span class="pln">  </span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">http-equiv</span><span class="pun">=</span><span class="atv">"X-UA-Compatible"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"ie=edge"</span><span class="tag">&gt;</span></code></li><li class="L6"><code><span class="pln">  </span><span class="tag">&lt;title&gt;</span><span class="pln">Document</span><span class="tag">&lt;/title&gt;</span></code></li><li class="L7"><code><span class="pln">  </span><span class="tag">&lt;style&gt;</span></code></li><li class="L8"><code><span class="pln">    </span><span class="pun">.</span><span class="pln">box </span><span class="pun">{</span></code></li><li class="L9"><code><span class="pln">      width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span></code></li><li class="L0"><code><span class="pln">      height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100px</span><span class="pun">;</span></code></li><li class="L1"><code><span class="pln">      position</span><span class="pun">:</span><span class="pln"> relative</span><span class="pun">;</span></code></li><li class="L2"><code><span class="pln">      background</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span></code></li><li class="L3"><code><span class="pln">      left</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span></code></li><li class="L4"><code><span class="pln">      top</span><span class="pun">:</span><span class="pln"> </span><span class="lit">10px</span><span class="pun">;</span></code></li><li class="L5"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L6"><code><span class="pln">  </span><span class="tag">&lt;/style&gt;</span></code></li><li class="L7"><code><span class="tag">&lt;/head&gt;</span></code></li><li class="L8"><code><span class="tag">&lt;body&gt;</span></code></li><li class="L9"><code><span class="pln">  </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"button"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"按钮"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"btn"</span><span class="tag">&gt;</span></code></li><li class="L0"><code><span class="pln">  </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"box"</span><span class="tag">&gt;&lt;/div&gt;</span></code></li><li class="L1"><code><span class="pln">  </span><span class="tag">&lt;script&gt;</span></code></li><li class="L2"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> btn </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">querySelector</span><span class="pun">(</span><span class="str">'.btn'</span><span class="pun">);</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> box </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">querySelector</span><span class="pun">(</span><span class="str">'.box'</span><span class="pun">);</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="pln">    </span><span class="kwd">var</span><span class="pln"> t </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">    btn</span><span class="pun">.</span><span class="pln">onclick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(){</span></code></li><li class="L8"><code><span class="pln">      </span><span class="com">// 让box向右运动</span></code></li><li class="L9"><code><span class="pln">      clearInterval</span><span class="pun">(</span><span class="pln">t</span><span class="pun">);</span></code></li><li class="L0"><code><span class="pln">      t </span><span class="pun">=</span><span class="pln"> setInterval</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">        box</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">left </span><span class="pun">=</span><span class="pln"> css</span><span class="pun">(</span><span class="pln">box</span><span class="pun">,</span><span class="pln"> </span><span class="str">'left'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">'px'</span><span class="pun">;</span></code></li><li class="L2"><code><span class="pln">      </span><span class="pun">},</span><span class="pln"> </span><span class="lit">20</span><span class="pun">);</span></code></li><li class="L3"><code><span class="pln">      console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">t</span><span class="pun">);</span></code></li><li class="L4"><code><span class="pln">    </span><span class="pun">};</span></code></li><li class="L5"><code><span class="pln">  </span><span class="tag">&lt;/script&gt;</span></code></li><li class="L6"><code><span class="tag">&lt;/body&gt;</span></code></li><li class="L7"><code><span class="tag">&lt;/html&gt;</span></code></li></ol></pre></div>
</body>
</html>